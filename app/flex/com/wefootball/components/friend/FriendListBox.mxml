<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns:mx="http://www.adobe.com/2006/mxml">

<mx:Metadata>
	[Event(name="userDisplay", type="com.wefootball.events.UserEvent")]
</mx:Metadata>

    <mx:Script>
    	<![CDATA[
    		import mx.collections.ArrayCollection;
    		import mx.controls.Alert;
    		import mx.rpc.events.ResultEvent;
    		import mx.rpc.events.FaultEvent;
    		import com.wefootball.events.UserEvent;
			import com.wefootball.model.Request;
			import com.wefootball.model.User;
			
    		[Bindable]
			private var friendList:ArrayCollection;			    			 				

			public function set userId(i:String):void {
				listFriend(i);
			}
    		 	
     		private function listFriend(user_id:String):void
     		{
     			User.listFriends(user_id,handleFriendListResult,handleFriendListFault);
     		}
     		
     		private function handleFriendListResult(event:ResultEvent,fl:ArrayCollection):void{
     			friendList = fl;		
     		}
     		
			private function handleFriendListFault(event:FaultEvent):void {
				Alert.show('Unknown Error', "Friends haven't been listed");
			}
     		internal function displayUser(data:Object):void{
     			dispatchEvent(new UserEvent("userDisplay", data.id));
     		}
    	]]>	
    </mx:Script>

<!--	这里暂时用currentUser的id，实际上应该来自于外部事件的参数-->
	<mx:TileList dataProvider="{friendList}" rowHeight="150" columnWidth="100">
		<mx:itemRenderer>
			<mx:Component>
				<mx:VBox click="outerDocument.displayUser(data)">
					<mx:Image source="{data.img}" width="80" height="80"/>
					<mx:Label text="{data.nickname}"/>			
				</mx:VBox>
        	</mx:Component>
        </mx:itemRenderer>
	</mx:TileList>
    
</mx:Canvas>

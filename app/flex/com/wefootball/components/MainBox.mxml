<?xml version="1.0" encoding="utf-8"?>
<mx:Canvas xmlns="*" xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:msg="com.wefootball.components.message.*" xmlns:acc="com.wefootball.components.account.*"
	width="100%" height="100%" creationComplete="init()">
<mx:Script>
<![CDATA[
	import com.wefootball.events.*;
	import mx.controls.Alert;
	import com.wefootball.model.User;
	import mx.managers.PopUpManager;
	
 	private function init():void
	{
		this.removeChild(settingWindow);
		this.removeChild(messageDetailWindow);
		this.removeChild(messageSendWindow);
		PopUpManager.addPopUp(settingWindow,this,false);
		PopUpManager.addPopUp(messageDetailWindow,this,false);
		PopUpManager.addPopUp(messageSendWindow,this,false);
		PopUpManager.centerPopUp(settingWindow);
		PopUpManager.centerPopUp(messageDetailWindow);
		PopUpManager.centerPopUp(messageSendWindow);
	}
	
	private function sendMessage(m:MessageDetailEvent):void {
		messageSendWindow.visible=true;
		messageSendBox.message = m.message;
	}
	
	private function displayMessage(m:MessageDetailEvent):void {
		messageDetailWindow.visible=true;
		messageDetailBox.messageId = m.message.id;
	}
	private function displayUser(u:UserDisplayEvent):void {
		informationBox.visible=true;
		informationBox.userId = u.user_id;
	}
	
	private function pouUpMySetting():void
	{
		settingWindow.visible = true;
	}
]]>
</mx:Script>
	<mx:TitleWindow id="settingWindow" title="{User.currentUser.nickname}的设置" visible="false"
		 showCloseButton="true" close="event.target.visible=false" borderColor="#A1DAED"  borderAlpha="1" width="414" horizontalCenter="-172" verticalCenter="-85">
		<acc:UpdateBox id="UpdateBox" user="{User.currentUser}"/>
	</mx:TitleWindow>
	
	<mx:TitleWindow id="messageDetailWindow" title="" visible="false"
		 showCloseButton="true" close="event.target.visible=false" borderColor="#A1DAED"  borderAlpha="1">
		<msg:MessageDetailBox id="messageDetailBox" 
			messageReply="messageDetailWindow.visible=false;sendMessage(event)"/>
	</mx:TitleWindow>
	
	<mx:TitleWindow id="messageSendWindow" title="" visible="false"
		 showCloseButton="true" close="event.target.visible=false" borderColor="#A1DAED"  borderAlpha="1">
		<msg:MessageSendBox id="messageSendBox" 
			messageSendCompleted="messageSendWindow.visible=false;"/>
	</mx:TitleWindow>
	
	<mx:VBox width="100%" height="100%">
		<mx:HBox height="100" width="100%" verticalAlign="bottom" horizontalAlign="right">
			<mx:LinkButton label="{User.currentUser.nickname}的设置" click="pouUpMySetting()"/>
		</mx:HBox>
	
		<mx:HBox width="100%" height="550">
			<mx:VBox width="100" height="100%">
				<mx:Button label="信箱" width="100" height="100"/>
			</mx:VBox>
			<mx:VBox width="100%" height="100%">
				<msg:MessageListBox id="messageListBox" backgroundColor="#FFFFFF"
					 userDisplay="displayUser(event)"
					 messageDisplay="displayMessage(event)"/>
				<acc:InformationBox id="informationBox" backgroundColor="#FFFFFF" 
					messageSend="sendMessage(event)"/>
			</mx:VBox>
		</mx:HBox>
	</mx:VBox>
</mx:Canvas>
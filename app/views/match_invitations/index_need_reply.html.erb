<div id="narrow_right_content" class="sect">
  <h2></h2>
  <%=render :partial=>'sidebar_menu'%>
</div>

<div id="wide_left_content" class="sect">
  <h2><%= h @title%></h2>
  <table class="list">
    <% @mis.each do |mi|%>
      <%
        self_team = @team
        another_team = @team == mi.host_team ? mi.guest_team : mi.host_team
      %>
      <tr>
        <td><%= team_icon(another_team)%></td>
        <td style="width:100%">
          <table class="match_invitation_list">
            <tr>
              <td>
                <%= mi.host_team == @team ? '本队' : '对方'%>
                <%=link_to h(mi.host_team.shortname), team_view_path(mi.host_team)%>发起的邀请
              </td>
            </tr>
            <tr>
              <td>
                <%=link_to h(another_team.shortname), team_view_path(another_team)%>提出建议后，等待我队的回复
              </td>
            </tr>
            <%msg = @team == mi.host_team ? mi.guest_team_message: mi.host_team_message%>
            <%if !msg.blank?%>
            <tr>
              <td>
                对方的留言: 
                <%= h(msg)%>
              </td>
            </tr>
            <%end%>
          </table>
          <br/>
          <table class="match_invitation_list">
            <tr>
              <td style="width:60px">&nbsp;</td>
              <td>对方提出的新建议</td>
              <td>我队上次提出的建议</td>
            </tr>
            <%= macth_invitation_comparison_tr(mi, '时间', :start_time){ |t| 
              %(#{t.strftime('%Y-%m-%d %H:%M')}
                #{"(已过期)" if mi.outdated?}
              )
            }%>
            <%= macth_invitation_comparison_tr(mi, '地点', :location){ |t| h t}%>
            <%= macth_invitation_comparison_tr(mi, '比赛性质', :match_type){ |t| match_type_text t}%>
            <%= macth_invitation_comparison_tr(mi, '人数', :size){ |t| "#{t}人制"}%>
            <%= macth_invitation_comparison_tr(mi, '半场时长', :half_match_length){ |t| "#{t}分钟"}%>
            <%= macth_invitation_comparison_tr(mi, '中间休息', :rest_length){ |t| "#{t}分钟"}%>
            <%= macth_invitation_comparison_tr(mi, '裁判', :has_judge){ |t| t ? '有' : '没有'}%>
            <%= macth_invitation_comparison_tr(mi, '红黄牌', :has_card){ |t| t ? '有' : '没有'}%>
            <%= macth_invitation_comparison_tr(mi, '越位', :has_offside){ |t| t ? '有' : '没有'}%>
            <%= macth_invitation_comparison_tr(mi, '平局后', :win_rule){ |t| win_rule_text t}%>
          </table>

          <div style="margin: 10px 0 10px 10px">
            <%if current_user.can_accpet_match_invitation?(mi)%>
              <%=link_to '接受对方的建议', matches_path(:id=>mi.id), :method=>:post%>
              &nbsp;&nbsp;|&nbsp;&nbsp;
            <%end%>
            <%if current_user.can_reject_match_invitation?(mi)%>
              <%=link_to "拒绝对方的建议", match_invitation_path(mi),:method=>:delete%>
              &nbsp;&nbsp;|&nbsp;&nbsp;
            <%end%>
            <%if current_user.can_edit_match_invitation?(mi)%>
              <%=link_to '提出新建议', edit_match_invitation_path(mi)%>
            <%end%>
          </div>
        </td>
        <td><%= team_icon(self_team)%></td>
      </tr>
    <%end%>
  </table>
</div>

<div class="clearBoth"></div>